package amazon;
import java.io.IOException;

import org.jsoup.Connection;
import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.nodes.Element;
import org.jsoup.select.Elements;

public class scraper {
	
	final static String BASE = "https://www.amazon.com/s/ref=lp_172659_st?rh=n%3A172282%2Cn%3A%21493964%2Cn%3A1266092011%2Cn%3A172659&qid=1520461163&sort=review-rank";
	final static String prefix = "https://www.amazon.com/s/ref=sr_pg_2?rh=n%3A172282%2Cn%3A%21493964%2Cn%3A1266092011%2Cn%3A172659&page=";
	final static String postfix = "&sort=review-rank&ie=UTF8&qid=1520474376";
	
	public static void main(String[] args) {
		
		//scrape(BASE);
//		for (int i = 2; i <= 42; i++) {
//			scrape(prefix + i + postfix);
//		}
		String u = prefix + 2 + postfix;
		
		System.out.println(u);
		
		scrape(prefix + 2 + postfix);
	}
	
	private static void scrape(String url) {
		Connection.Response response = null;
		
		try {
			response = Jsoup.connect(url).followRedirects(true).execute();
		} catch (IOException e) {
			//connection failed
			e.printStackTrace();
		}
		
		if (response != null && response.statusCode() == 200) {
			
			Document doc = null;
			
			try {
				doc = response.parse();
			}
			catch (Exception e) {
				e.printStackTrace();
			}
			
			Elements result = null;
			for (int i = 0; i <= 23; i++) {
				result = doc.select("#result_" + i);
				
				System.out.println(i);
				Item item = new Item(1, result.first());
			}

		}
		
	}

}
